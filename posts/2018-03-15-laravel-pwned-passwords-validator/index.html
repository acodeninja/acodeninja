<!doctype html><html lang=en><head><title>laravel pwned passwords validator ::
acode.ninja — Adventures of a code ninja</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="a bit about pwned passwords So, a while ago the pwned passwords database was made available to the public. It was a great idea, a collection of all the discrete passwords that had been included in all the data breaches from ';&amp;ndash;have i been pwned?. Annoyingly to check this database with version 1 of the api you could only specify a username to see if that was included in a breach."><meta name=keywords content="software developer,coder,learning to code,laravel,haveibeenpwned,security,password security"><meta name=robots content="noodp"><link rel=canonical href=/posts/2018-03-15-laravel-pwned-passwords-validator/><link rel=stylesheet href=/assets/style.css><link rel=stylesheet href=/style.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=/img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/img/favicon.png><link href=/assets/fonts/Inter-Italic.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/assets/fonts/Inter-Regular.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/assets/fonts/Inter-Medium.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/assets/fonts/Inter-MediumItalic.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/assets/fonts/Inter-Bold.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/assets/fonts/Inter-BoldItalic.woff2 rel=preload type=font/woff2 as=font crossorigin><meta name=twitter:card content="summary"><meta name=twitter:title content="laravel pwned passwords validator"><meta name=twitter:description content="a bit about pwned passwords So, a while ago the pwned passwords database was made available to the public. It was a great idea, a collection of all the discrete passwords that had been included in all the data breaches from ';&ndash;have i been pwned?. Annoyingly to check this database with version 1 of the api you could only specify a username to see if that was included in a breach."><meta property="og:title" content="laravel pwned passwords validator"><meta property="og:description" content="a bit about pwned passwords So, a while ago the pwned passwords database was made available to the public. It was a great idea, a collection of all the discrete passwords that had been included in all the data breaches from ';&ndash;have i been pwned?. Annoyingly to check this database with version 1 of the api you could only specify a username to see if that was included in a breach."><meta property="og:type" content="article"><meta property="og:url" content="/posts/2018-03-15-laravel-pwned-passwords-validator/"><meta property="article:published_time" content="2018-03-15T00:00:00+00:00"><meta property="article:modified_time" content="2018-03-15T00:00:00+00:00"><meta property="og:site_name" content="acode.ninja"></head><body class=dark-theme><div class=container><header class=header><span class=header__inner><a href=/ class=logo style=text-decoration:none><span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg></span><span class=logo__text>acode.ninja</span>
<span class=logo__cursor></span></a><span class=header__right><span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41C32.4934 41 41 32.4934 41 22 41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><div class=post><h1 class=post-title>laravel pwned passwords validator</h1><div class=post-meta><span class=post-date>2018-03-15</span>
<span class=post-read-time>— 2 min read</span></div><div class=post-content><h2 id=a-bit-about-pwned-passwords>a bit about pwned passwords</h2><p>So, a while ago the pwned passwords database was made available to the public.
It was a great idea, a collection of all the discrete passwords that had been
included in all the data breaches from <a href=https://haveibeenpwned.com/>';&ndash;have i been pwned?</a>.
Annoyingly to check this database with version 1 of the api you could only
specify a username to see if that was included in a breach.</p><p>With the release of the pwned passwords list, we can now check individual
passwords to see if they were included in a breach. So why not check this list
when registering new users and maintain the integrity of your user accounts.
This idea isn&rsquo;t new, and I heard it on Risky Business <a href=https://risky.biz/RB488/>E488</a>.</p><h2 id=why-a-laravel-package>why a laravel package?</h2><p>I thought hells yeah, great idea, but where is the easiest place I can make this
module work with the most impact for my own projects? <a href=https://laravel.com/>Laravel</a>.</p><p>Almost every large scale project I have worked on, has been written using the
laravel framework. So why not just add a validator to this great framework to
allow developers to quickly drop in a check against this database.</p><h2 id=why-should-i-send-passwords-to-some-random-api>why should I send passwords to some random api?</h2><p>Don&rsquo;t worry, this package won&rsquo;t do anything as stupid as this. First it will
make a SHA1 hash of the password, then send the first 5 characters to the api.
The response from the API will contain a full list of hashes that match the
prefix we sent. If the rest of the hash exists in the list, then the validation
fails, and the error is returned to the validator instance.</p><h2 id=including-in-your-project>including in your project</h2><p>Using this validator is really easy, check out the <a href=https://github.com/acodeninja/laravel-pwned-passwords-validator>Github Repo</a>
or just use composer to install it</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ composer require acodeninja/laravel-pwned-passwords-validator
</code></pre></div><p>Then use it either in your request classes</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#e6db74>/**  
</span><span style=color:#e6db74> * Get the validation rules that apply to the request.  
</span><span style=color:#e6db74> *  
</span><span style=color:#e6db74> * @return array 
</span><span style=color:#e6db74> */</span>
<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>rules</span>()
{
    <span style=color:#66d9ef>return</span> [
        <span style=color:#e6db74>&#39;email&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;required|email|unique:users,email&#39;</span>, 
        <span style=color:#e6db74>&#39;password&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;required|pwned_password_strict&#39;</span>,
    ];
}
</code></pre></div><p>Or your controllers (if you swing that way)</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php>$validator <span style=color:#f92672>=</span> <span style=color:#a6e22e>Validator</span><span style=color:#f92672>::</span><span style=color:#a6e22e>make</span>($request<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>all</span>(), [
    <span style=color:#e6db74>&#39;email&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;required|email|unique:users,email&#39;</span>, 
    <span style=color:#e6db74>&#39;password&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;required|pwned_password_strict&#39;</span>,
])<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>validate</span>();
</code></pre></div><h2 id=thanks>thanks</h2><p>Thanks go out to <a href=https://twitter.com/riskybusiness>Patrick Gray</a> for a great
podcast that I&rsquo;ve followed for years, and to <a href=https://twitter.com/troyhunt>Troy Hunt</a>
for making a great resource that is really simple to leverage and increases the
security of the internet as a whole.</p></div></div></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user">Lawrence Goldstien</div></div></footer><script src=/assets/main.js></script><script src=/assets/prism.js></script></div></body></html>