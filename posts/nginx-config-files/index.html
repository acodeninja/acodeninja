<!DOCTYPE html>
<html class="light" lang="en"><head>
  <meta charset="utf-8">
  <meta name="viewport"
        content="width=device-width, initial-scale=1, shrink-to-fit=no"
  />

  <meta name="description"
        content="Ever since moving to Nginx I have had the self-satisfied smile of someone who knows his web applications are going to be snappy. That&amp;rsquo;s not just down to good coding, but down to the quality of the server software employed.
One problem that I came across with Nginx was implementing features found in the .htaccess files you would usually use to set per site and directory settings within PHP and Apache."
  />
  <meta name="keywords"
        content="software developer, coder, learning to code"
  />

  <link rel="canonical" href="/posts/nginx-config-files/" />

  <title>nginx config files | üë®‚Äçüíª Adventures of a code ninja</title>

  <link rel="stylesheet" media="all" href="/all.css"/>
  <link rel="stylesheet" media="screen" href="/screen.css"/>
  <link rel="stylesheet" media="screen" href="/app.css"/>
</head>
<body><header>
  <nav>
    <a href="/">
      
        üë®‚Äçüíª adventures of a code ninja
      
    </a>
    <ul>
      
        <li>
          <a href="/posts">
            blog
          </a>
        </li>
      
    </ul>
    <div id="theme-toggle"></div>
  </nav>
</header>
<main>
  <h1>nginx config files</h1>
  <nav id="TableOfContents"></nav>
  <br><br>
  <p>Ever since moving to Nginx I have had the self-satisfied smile of someone who
knows his web applications are going to be snappy. That&rsquo;s not just down to good
coding, but down to the quality of the server software employed.</p>
<p>One problem that I came across with Nginx was implementing features found in the
.htaccess files you would usually use to set per site and directory settings
within PHP and Apache. No longer would these work out of the box, so a new tack
was needed.</p>
<p>Nginx has a pretty good config file structure, easy to read, logical and above
all nice to look at. A standard server without any PHP looks a little something
like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-nginx" data-lang="nginx"><span style="color:#66d9ef">server</span> { 	
    <span style="color:#f92672">root</span> <span style="color:#e6db74">/var/www/onmylemon.co.uk/www</span>; 	
    <span style="color:#f92672">index</span> <span style="color:#e6db74">index.html</span>;

    <span style="color:#f92672">access_log</span>  <span style="color:#e6db74">/var/www/onmylemon.co.uk/access.log</span>;
    <span style="color:#f92672">error_log</span>  <span style="color:#e6db74">/var/www/onmylemon.co.uk/error.log</span>;

    <span style="color:#f92672">server_name</span> <span style="color:#66d9ef">on</span><span style="color:#e6db74">mylemon.co.uk</span> <span style="color:#e6db74">www.onmylemon.co.uk</span>;
}
</code></pre></div><p>How nice does that look? On Debian you just drop this into the
<code>/etc/nginx/conf.d</code> directory (making sure to call it somthing.conf) and run
sudo <code>/etc/init.d/nginx restart</code>. On Ubuntu it is even easier, just drop this
into /etc/nginx/sites-available/onmylemon.co.uk, run <code>ngxensite</code> then
<code>sudo /etc/init.d/nginx restart</code>.</p>
<p>Try hammering it a little, I usually use loadimpact for this and you can run a
few free tests every day against a URL of your choice.</p>
<p>Now you have this maybe lets try some PHP in there? You will need to get
php5-fpm up and running but this isn‚Äôt too much of a challenge. A small
alteration needs to be made to the configuration we used previously.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-nginx" data-lang="nginx"><span style="color:#66d9ef">server</span> { 	
    <span style="color:#f92672">root</span> <span style="color:#e6db74">/var/www/onmylemon.co.uk/www</span>; 	
    <span style="color:#f92672">index</span> <span style="color:#e6db74">index.html</span>;

    <span style="color:#f92672">access_log</span>  <span style="color:#e6db74">/var/www/onmylemon.co.uk/access.log</span>;
    <span style="color:#f92672">error_log</span>  <span style="color:#e6db74">/var/www/onmylemon.co.uk/error.log</span>;

    <span style="color:#f92672">server_name</span> <span style="color:#66d9ef">on</span><span style="color:#e6db74">mylemon.co.uk</span> <span style="color:#e6db74">www.onmylemon.co.uk</span>;

    <span style="color:#f92672">location</span> ~ <span style="color:#e6db74">\.php$</span> {
        <span style="color:#f92672">fastcgi_split_path_info</span> <span style="color:#e6db74">^(.+\.php)(/.+)</span>$;
        <span style="color:#f92672">fastcgi_pass</span> 127.0.0.1:<span style="color:#ae81ff">9000</span>;
        <span style="color:#f92672">fastcgi_index</span> <span style="color:#e6db74">index.php</span>;
        <span style="color:#f92672">include</span> <span style="color:#e6db74">fastcgi_params</span>;
    }
}
</code></pre></div><p>The first thing I noticed was <code>fastcgi_pass 127.0.0.1:9000;</code> at first it didn‚Äôt
sink in, but then I realised this is one of Nginx more interesting features.
This allows you to pass php execution off to other servers thus using the server
with Nginx on it purely as a reverse proxy.</p>
<p>So this just covers some basic stuff with the configuration files, I‚Äôll be
putting up more information as I delve deeper.</p>


</main><footer>
  <div>&copy; Lawrence Goldstien</div>
  <a href="/privacy">Privacy</a>
  <div>My opinions are my own</div>
</footer>
<div id="tracker"></div>
<script src="/app.js"></script>
</body>
</html>
