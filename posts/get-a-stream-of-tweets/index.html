<!doctype html><html class=light lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=description content="The first part of the course I have been taking on data science deals with analysis of Twitter data. This is aimed at discerning the overall sentiment of a Tweet or collection of tweets.
To get this going the first thing you need is a big collection of tweets in a format that is easy for a program to digest. Step in JSON, a text based output that represents data in a collection of arrays."><meta name=keywords content="software developer,coder,learning to code"><link rel=canonical href=/posts/get-a-stream-of-tweets/><title>get a stream of tweets | Adventures of a code ninja</title><link rel=stylesheet media=all href=/all.css><link rel=stylesheet media=screen href=/screen.css><link rel=stylesheet media=screen href=/app.css></head><body><header><nav><a href=/>adventures of a code ninja</a><ul><li><a href=/posts>blog</a></li></ul><div id=theme-toggle></div></nav></header><main><h1>get a stream of tweets</h1><nav id=TableOfContents></nav><br><br><p>The first part of the course I have been taking on data science deals with
analysis of Twitter data. This is aimed at discerning the overall sentiment of a
Tweet or collection of tweets.</p><p>To get this going the first thing you need is a big collection of tweets in a
format that is easy for a program to digest. Step in JSON, a text based output
that represents data in a collection of arrays. Once you have this data set you
can then start experimenting. Maybe try something simple first, like taking ten
minutes worth of samples every hour and mapping the twitter activity for an
average of how many tweets per country for that hour.</p><p>Twitter Stream
From &ldquo;Introduction to Data Science&rdquo; A coursera program with lectures from
Bill Howe. You will need to edit the access and consumer credentials to make this
application work.</p><p>Run as follows: <code>python twitterstream.py > output.json</code></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>import</span> oauth2 <span style=color:#f92672>as</span> oauth import urllib2 <span style=color:#f92672>as</span> urllib

accesstokenkey <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&lt;Enter your access token key here&gt;&#34;</span> 
accesstokensecret <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&lt;Enter your access token secret here&gt;&#34;</span>

consumerkey <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&lt;Enter consumer key&gt;&#34;</span> 
consumersecret <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&lt;Enter consumer secret&gt;&#34;</span>

_debug <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>

oauthtoken <span style=color:#f92672>=</span> oauth<span style=color:#f92672>.</span>Token(key<span style=color:#f92672>=</span>accesstokenkey, secret<span style=color:#f92672>=</span>accesstokensecret) 
oauthconsumer <span style=color:#f92672>=</span> oauth<span style=color:#f92672>.</span>Consumer(key<span style=color:#f92672>=</span>consumerkey, secret<span style=color:#f92672>=</span>consumersecret)

signaturemethodhmacsha1 <span style=color:#f92672>=</span> oauth<span style=color:#f92672>.</span>SignatureMethodHMAC_SHA1()

http_method <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;GET&#34;</span>

httphandler <span style=color:#f92672>=</span> urllib<span style=color:#f92672>.</span>HTTPHandler(debuglevel<span style=color:#f92672>=</span>debug) 
httpshandler <span style=color:#f92672>=</span> urllib<span style=color:#f92672>.</span>HTTPSHandler(debuglevel<span style=color:#f92672>=</span>debug)

<span style=color:#e6db74>&#39;&#39;&#39;Construct, sign, and open a twitter request 
</span><span style=color:#e6db74>   using the hard-coded credentials above.&#39;&#39;&#39;</span> 

<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>twitterreq</span>(url, method, parameters): 
    req <span style=color:#f92672>=</span> oauth<span style=color:#f92672>.</span>Request<span style=color:#f92672>.</span>fromconsumerandtoken(oauthconsumer,
                                             token<span style=color:#f92672>=</span>oauthtoken,
                                             httpmethod<span style=color:#f92672>=</span>httpmethod, 
                                             httpurl<span style=color:#f92672>=</span>url, 
                                             parameters<span style=color:#f92672>=</span>parameters)

    req<span style=color:#f92672>.</span>signrequest(signaturemethodhmacsha1, oauthconsumer, oauthtoken)

    headers <span style=color:#f92672>=</span> req<span style=color:#f92672>.</span>to_header()

    <span style=color:#66d9ef>if</span> httpmethod <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;POST&#34;</span>:
        encodedpostdata <span style=color:#f92672>=</span> req<span style=color:#f92672>.</span>topostdata()
    <span style=color:#66d9ef>else</span>:
        encodedpostdata <span style=color:#f92672>=</span> None

    url <span style=color:#f92672>=</span> req<span style=color:#f92672>.</span>to_url()

    opener <span style=color:#f92672>=</span> urllib<span style=color:#f92672>.</span>OpenerDirector()
    opener<span style=color:#f92672>.</span>addhandler(httphandler) 
    opener<span style=color:#f92672>.</span>addhandler(httpshandler)

    response <span style=color:#f92672>=</span> opener<span style=color:#f92672>.</span>open(url, encodedpostdata)

    <span style=color:#66d9ef>return</span> response

<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>fetchsamples</span>(): 
    url <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;https://stream.twitter.com/1/statuses/sample.json&#34;</span>
    parameters <span style=color:#f92672>=</span> []
    response <span style=color:#f92672>=</span> twitterreq(url, <span style=color:#e6db74>&#34;GET&#34;</span>, parameters)
    
    <span style=color:#66d9ef>for</span> line <span style=color:#f92672>in</span> response:
        <span style=color:#66d9ef>print</span> line<span style=color:#f92672>.</span>strip()

<span style=color:#66d9ef>if</span> name  <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;main&#39;</span>:
    fetchsamples()
</code></pre></div></main><footer><div>&copy; Lawrence Goldstien</div><a href=/privacy>Privacy</a><div>My opinions are my own</div></footer><div id=tracker></div><script src=/app.js></script></body></html>